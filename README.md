# Python課題チェッカー

プログラミング授業などで提出されたPythonの課題を自動で評価するためのスクリプトです。

単なるテキスト比較だけでなく、コードの構造的な類似性や実行可否を評価することで、より多角的な分析をサポートします。

## 主な機能

- **実行可否の評価**: 
  - 提出されたスクリプトを安全な環境で実行し、「成功」「実行時エラー」「タイムアウト」を判定します。
  - 無限ループや悪意のあるコードから保護するため、実行時間制限が設けられています。

- **ASTによる高精度な類似度分析**:
  - コードをAST（抽象構文木）に変換して比較することで、コメントや変数名、空白といった表面的な違いに影響されない、本質的なロジックの類似度を算出します。

- **多段階評価**:
  - 類似度の高さに応じて、結果を「A, B, C, D」の4段階で評価します。

- **柔軟なファイル名解析**:
  - `b1234567_山田太郎.py` や `b1234567 山田太郎.py` のような様々な形式のファイル名から、正規表現を使って学籍番号と氏名を自動で抽出します。

- **Excelへのレポート出力**:
  - 学生ごとの評価結果（実行可否、類似度、評価）を、分かりやすいExcelファイルにまとめて出力します。

## 必要なモジュール

本スクリプトの実行には、`openpyxl`が必要です。
以下のコマンドでインストールしてください。

```bash
pip install openpyxl
```

その他のモジュール（`os`, `re`, `ast`, `difflib`, `argparse`, `subprocess`）はPythonの標準ライブラリに含まれています。

## 使い方

以下のコマンド形式でスクリプトを実行します。

```bash
python assignment_checker.py [模範解答ファイル] [提出物ディレクトリ]
```

### 引数

1.  `模範解答ファイル`: 評価の基準となる模範解答のPythonファイル（`.py`）へのパス。
2.  `提出物ディレクトリ`: 学生から提出された課題ファイルが格納されているディレクトリへのパス。

### 実行例

```bash
# 模範解答 `answers/q1.py` と、`submissions/` ディレクトリ内の提出物を比較
python assignment_checker.py answers/q1.py submissions/
```

### 出力

- **コンソール**: 各ファイルの評価結果がリアルタイムで表示されます。
- **Excelファイル**: `チェック結果_{提出物ディレクトリ名}.xlsx` という名前のファイルが生成され、詳細な評価レポートが保存されます。

## 質問・フィードバック

質問や改善点がある場合は、お気軽にご連絡ください。
